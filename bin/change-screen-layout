#!/usr/bin/env bash
#
# Changes screen layout using xrandr.
#
# change-screen-layout --mode={clone|dual|dual-vertical|external|laptop} [--intern=eDP1] [--extern=HDMI1]

INTERN=eDP1
EXTERN=HDMI1

usage()
{
   printf "\nUsage: %s --mode=<mode> [--intern=<output>] [--extern=<output>]\n\n" "$0"
   printf "\tmode\t{clone|dual|dual-vertical|external|laptop}\n"
   printf "\tintern\tdefaults to eDP1\n"
   printf "\textern\tdefaults to HDMI1\n"
}

for i in "$@"
do
  case $i in
    -m=*|--mode=*)
      MODE="${i#*=}"
      ;;
    --extern=*)
      EXTERN="${i#*=}"
      ;;
    --intern=*)
      INTERN="${i#*=}"
      ;;
    *)
      usage
      exit 1
      ;;
  esac
done

case $MODE in
  "clone")
    COMMAND=(xrandr --output "$INTERN" --auto --output "$EXTERN" --auto --same-as "$INTERN")
    ;;
  "dual")
    COMMAND=(xrandr --output "$INTERN" --auto --output "$EXTERN" --primary --auto --right-of "$INTERN")
    ;;
  "dual-vertical")
    COMMAND=(xrandr --output "$INTERN" --auto --output "$EXTERN" --primary --auto --above "$INTERN")
    ;;
  "external")
    COMMAND=(xrandr --output "$INTERN" --off --output "$EXTERN" --auto)
    ;;
  "laptop")
    COMMAND=(xrandr --output "$INTERN" --auto --output "$EXTERN" --off)
    ;;
  *)
    echo "ERROR: Unknown mode \"$MODE\""
    usage
    exit 1
esac

"${COMMAND[@]}"
